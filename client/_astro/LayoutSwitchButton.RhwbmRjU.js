import{o as w,i as E}from"./lifecycle.CpGrwxA2.js";import{c as z,d as C,a as l,p as I,b as H,s as h,g as a,m as g,k as x,u as M,f as B,h as T,r as V,t as j,a3 as y}from"./template.BopZwMnL.js";import{e as F}from"./utils.DkllL2ii.js";import{i as L}from"./if.DgI-gtYW.js";import{a as W}from"./attributes.Do_Oav4S.js";import{p as q}from"./props.DsdNDwWf.js";import{s as p}from"./config.RG7Zm9cy.js";import"./clsx.B-dksMZM.js";var A=y('<svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M4 6h16v2H4zm0 5h16v2H4zm0 5h16v2H4z"></path></svg>'),D=y('<svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M3 3h7v7H3V3zm0 11h7v7H3v-7zm11-11h7v7h-7V3zm0 11h7v7h-7v-7z"></path></svg>'),G=B('<button aria-label="切换文章列表布局" class="btn-plain scale-animation rounded-lg h-11 w-11 active:scale-90 flex items-center justify-center"><!></button>');function X(_,f){H(f,!1);let s=q(f,"currentLayout",12,"list"),r=g(!1),i=g(!1);function u(){h(i,window.innerWidth<1200),a(i)&&s("list")}w(()=>{h(r,!0),u();const t=localStorage.getItem("postListLayout");return t&&(t==="list"||t==="grid")&&s(t),window.addEventListener("resize",u),()=>{window.removeEventListener("resize",u)}});function S(){if(!a(r)||a(i))return;s(s()==="list"?"grid":"list"),localStorage.setItem("postListLayout",s());const t=new CustomEvent("layoutChange",{detail:{layout:s()}});window.dispatchEvent(t)}w(()=>{const t=e=>{s(e.detail.layout)};return window.addEventListener("layoutChange",t),()=>{window.removeEventListener("layoutChange",t)}}),w(()=>{const t=o=>{s(o.detail.layout)},e=()=>{setTimeout(()=>{console.log("Swup event - syncing layout state");const o=localStorage.getItem("postListLayout");if(o&&(o==="list"||o==="grid"))s(o);else{const c=p.postListLayout.defaultMode;s(c)}},200)};window.addEventListener("layoutInit",t);function d(){if(typeof window<"u"&&window.swup){const o=window.swup;o.hooks.on("content:replace",e),o.hooks.on("page:view",e),o.hooks.on("animation:in:end",e),console.log("Swup button listeners registered")}else window.addEventListener("popstate",e),console.log("Fallback button listeners registered")}return setTimeout(d,200),()=>{if(window.removeEventListener("layoutInit",t),typeof window<"u"&&window.swup){const o=window.swup;o.hooks.off("content:replace",e),o.hooks.off("page:view",e),o.hooks.off("animation:in:end",e)}else window.removeEventListener("popstate",e)}}),E();var m=z(),b=C(m);{var k=t=>{var e=G(),d=T(e);{var o=n=>{var v=A();l(n,v)},c=n=>{var v=D();l(n,v)};L(d,n=>{s()==="list"?n(o):n(c,!1)})}V(e),j(()=>W(e,"title",s()==="list"?"切换到网格模式":"切换到列表模式")),F("click",e,S),l(t,e)};L(b,t=>{a(r),x(p),a(i),M(()=>a(r)&&p.postListLayout.allowSwitch&&!a(i))&&t(k)})}l(_,m),I()}export{X as default};
